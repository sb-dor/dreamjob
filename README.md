the architecture is messed now, will fix it later.